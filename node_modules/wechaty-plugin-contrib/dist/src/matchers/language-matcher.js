"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.includeLanguage = exports.languageMatcher = exports.detectLanguage = void 0;
const wechaty_1 = require("wechaty");
const languageMonitor = require('language-monitor');
function detectLanguage(text, limit) {
    return languageMonitor(text, limit);
}
exports.detectLanguage = detectLanguage;
function includeLanguage(resultList, language, threshold = 0.1) {
    const minThreshold = (min) => (result) => result.rate > min;
    const toCode = (result) => result.code;
    return resultList
        .filter(minThreshold(threshold))
        .map(toCode)
        .includes(language);
}
exports.includeLanguage = includeLanguage;
function languageMatcher(options) {
    wechaty_1.log.verbose('WechatyQnAMaker', 'languageMatcher(%s)', JSON.stringify(options));
    let codeList;
    if (Array.isArray(options)) {
        codeList = options;
    }
    else {
        codeList = [options];
    }
    return function matchLanguage(text) {
        const resultList = detectLanguage(text);
        return codeList.some(code => includeLanguage(resultList, code));
    };
}
exports.languageMatcher = languageMatcher;
//# sourceMappingURL=language-matcher.js.map